package com.example.plumbersunite;

import java.sql.*;

public class userBusinessObject {
    private int id;
    private String name;
    private String pass;
    public userBusinessObject() {
        id=0;
        name="";
        pass="";
    }
    public userBusinessObject(int i, String n, String p) {
        id=i;
        name=n;
        pass=p;
    }
    public void selectDB(int i) {
        id=i;
        try{
            Class.forName("net.ucanaccess.jdbc.UcanaccessDriver");
            Connection c1 = DriverManager.getConnection("jdbc:ucanaccess:/C:/Users/Ndure/PlumbersUDatabase1.accdb");
            Statement stmt = c1.createStatement();
            String sql = "Select * from users where user_id = '"+getid()+"'";
            ResultSet rs = stmt.executeQuery(sql);
            System.out.println(sql);
            rs.next();
            name = rs.getString(2);
            pass = rs.getString(3);
            c1.close();
        } catch(Exception e) {
            System.out.println(e);
        }
    }
    public void insertDB(int i, String n, String p) {
        id=i;
        name=n;
        pass=p;
        try{
            Class.forName("net.ucanaccess.jdbc.UcanaccessDriver");
            Connection c1 = DriverManager.getConnection("jdbc:ucanaccess:/C:/Users/Ndure/PlumbersUDatabase1.accdb");
            Statement stmt = c1.createStatement();
            String sql = "Insert into users values('"+getid()+"','"+getname()+"','"+getpass()+"')";
            System.out.println(sql);
            int n1 = stmt.executeUpdate(sql);
            if (n1==1)
                System.out.println("INSERT SUCCESSFUL!");
            else
                System.out.println("INSERT FAILED");
            c1.close();
        } catch(Exception e) {
            System.out.println(e);
        }
    }
    public void deleteDB() {
        try{
            Class.forName("net.ucanaccess.jdbc.UcanaccessDriver");
            Connection c1 = DriverManager.getConnection("jdbc:ucanaccess:/C:/Users/Ndure/PlumbersUDatabase1.accdb");
            Statement stmt = c1.createStatement();
            String sql = "Delete from users where user_id='"+getid()+"'";
            System.out.println(sql);
            int n = stmt.executeUpdate(sql);
            if (n==1)
                System.out.println("DELETE SUCCESSFUL!");
            else
                System.out.println("DELETE FAILED");
            c1.close();
        } catch(Exception e) {
            System.out.println(e);
        }
    }
    public void updateDB() {
        try{
            Class.forName("net.ucanaccess.jdbc.UcanaccessDriver");
            Connection c1 = DriverManager.getConnection("jdbc:ucanaccess:/C:/Users/Ndure/PlumbersUDatabase1.accdb");
            Statement stmt = c1.createStatement();
            String sql = "Update users set username='"+getname()+"',"+" user_pass='"+getpass()+"',"+" where user_id='"+getid()+"'";
            System.out.println(sql);
            int n =stmt.executeUpdate(sql);
            if (n==1)
                System.out.println("UPDATE SUCCESSFUL!");
            else
                System.out.println("UPDATE FAILED");
            c1.close();
        } catch(Exception e) {
            System.out.println(e);
        }
    }
    
    public int getid() {return id;}
    public void setid(int i) {id=i;}
    
    public String getname() {return name;}
    public void setname(String n) {name=n;}
    
    public String getpass() {return pass;}
    public void setpass(String p) {pass=p;}
    
    public void display() {
        System.out.println("Id: " + id);
        System.out.println("Name: " + name);
        System.out.println("Pass: " + pass);
    }
}
